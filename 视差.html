<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<style>
*{margin:0;padding:0}
#box{ width:600px; height:400px; position:relative; margin:20px auto; border:1px solid #000;}
#box div>div{width:120px; height:120px; position:absolute; background:red;}
#front #div1{left:120px; top:120px; background:green; z-index:2; }
#front #div2{left:300px; top:130px; background:green; z-index:2; }

#behind #div3{ left:100px; top:80px;}
#behind #div4{ left:280px; top:90px;}
</style>
<script>
window.onload=function(){
	var oBox=document.getElementById('box'),
		oFront=document.getElementById('front'),
		oF1=oFront.children[0],
		oF2=oFront.children[1],
		oBack=document.getElementById('behind'),
		oB1=oBack.children[0],
		oB2=oBack.children[1];
	
	mouseWheel(oBox,function(bDown){
		move(bDown);
	});
	
	function move(bDown){
		var spF1=20;
		var spB1=10;
		if(!bDown){
			spF1*=-1;
			spB1*=-1;
		}
		var f1Left=oF1.offsetLeft+spF1;
		var f1MaxLeft=parseInt(getStyle(oBox,'width'))-parseInt(getStyle(oF1,'width'));
		f1Left<0 && (f1Left=0);
		f1Left>f1MaxLeft && (f1Left=f1MaxLeft);
		
		var f2Left=oF2.offsetLeft+spF1;
		var f2MaxLeft=parseInt(getStyle(oBox,'width'))-parseInt(getStyle(oF2,'width'));
		f2Left<180 && (f2Left=180);
		f2Left>f2MaxLeft && (f2Left=f2MaxLeft);
		
		oF1.style.left=f1Left+'px';
		oF2.style.left=f2Left+'px';
		
		var b1Left=oB1.offsetLeft+spB1;
		var b1MaxLeft=parseInt(getStyle(oBox,'width'))-parseInt(getStyle(oB1,'width'));
		b1Left<0 && (b1Left=0);
		b1Left>b1MaxLeft && (b1Left=b1MaxLeft);
		
		var b2Left=oB2.offsetLeft+spB1;
		var b2MaxLeft=parseInt(getStyle(oBox,'width'))-parseInt(getStyle(oB2,'width'));
		b2Left<180 && (b2Left=180);
		b2Left>b2MaxLeft && (b2Left=b2MaxLeft);
		
		oB1.style.left=b1Left+'px';
		oB2.style.left=b2Left+'px';
		
	}
}

function getStyle(obj,attr){
	return obj.currentStyle?obj.currentStyle[attr]:getComputedStyle(obj,false)[attr];
}

function mouseWheel(obj,fn){
	
	if(navigator.userAgent.toLowerCase().indexOf('firefox')!=-1){
		addEvent(obj,'DOMMouseScroll',function(ev){
			var oEvent=ev||event;
			var bDown=oEvent.detail>0?true:false;
			fn && fn(bDown);
		});
	}else{
		addEvent(obj,'mousewheel',function(ev){
			var oEvent=ev||event;
			var bDown=oEvent.wheelDelta>0?false:true;
			fn && fn(bDown);
		});
	}
	
}

function addEvent(obj,sEv,fn){
	if(obj.attachEvent){
		obj.attachEvent('on'+sEv,fn);
	}else{
		obj.addEventListener(sEv,fn,false);
	}
	
}

</script>
</head>

<body>
<div id="box">
	<div id="front">
		<div id='div1'></div>
		<div id='div2'></div>
	</div>
	<div id="behind">
		<div id='div3'></div>
		<div id='div4'></div>
	</div>
</div>
</body>
</html>
